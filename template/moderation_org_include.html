<%inherit file="base.html"/>

<%def name="title()"><% return u"Company Inclusion" %></%def>

<%def name="inclusion_table(key)">
  <p>${len(packet[key])}</p>
  <table>
    <tbody>
<%
last_tags = None
%>
      %for row in packet[key]:
<%
(org, dsei, sap, sipri) = row
tags = []
if dsei:
    tags.append("D")
if sap:
    tags.append("P")
if sipri:
    tags.append("S")
%>
%if last_tags and tags != last_tags:
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
%endif
      <tr>
        <td><a 
               href="${url_rewrite(org.url + '/tag', {
                     'sort':'name',
                     'path':True,
                     'visibility':'all',
                     'view':'edit',
                     })}"
               >${org.name}</a>
%if tags:
${", ".join(tags)}
%endif
</td>
      </tr>
<%
last_tags = tags
%>
      %endfor
    </tbody>
  </table>
</%def>

<%def name="page()">

<h1>Company Inclusion</h1>

<p>Current inclusion criteria:</p>
<p>(DSEi exhibitor <strong>and</strong> Military export applicant) <strong>or</strong> SIPRI top 100</p>

<div class="mango-box third">
  <p class="visibility public">These orgs are public, and meet the inclusion criteria.</p>
  ${self.inclusion_table("included")}
</div>

<div class="mango-box third">
  <p class="visibility public">These orgs are public, but don't meet the inclusion criteria.</p>
  ${self.inclusion_table("over_included")}
</div>

<div class="mango-box third">
  <p class="visibility pending">These orgs meet the inclusion criteria, but are still pending.</p>
  ${self.inclusion_table("under_included_pending")}
  <p>&nbsp</p>
  <p>&nbsp</p>
  <p class="visibility private">These orgs meet the inclusion criteria, but are private.</p>
  ${self.inclusion_table("under_included_private")}
</div>

</%def>

